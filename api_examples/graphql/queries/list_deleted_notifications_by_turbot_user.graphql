# Description
# -----------
#
#
# The query returns the data from activity log.
# Filters all the notifications from the activity log that are deleted by Turbot.
# The query filters resources,policy settings,policy values,controls,actions,scheduled actions,grants,
# active grants,favorites,watchs anything that are deleted by Turbot.

# Substitute
# ----------
#
# Substitute real values for the token <actor_indentity_id>.
#
# <actor_indentity_id>:
#   Any valid actor identity id can be substituted.
#   To get actor identity id for a user, please see GraphQL example:
#     `get_user_actor_identity_id.graphql`.
#   To get the actor identity id for Turbot identity, please see GraphQL example:
#     `get_turbot_actor_identity_id.graphql.graphql`.
#
# Substitute any valid value from the list of notification types that are available in <type>/<notificationType>.
#
# <type>/<notificationType>:
#   Filter on the general type of notifications.
#   This will filter all create, update, and delete notifications of a given class. 
#

# Execute
# -------
#
# To execute the query after substitution, run the Turbot CLI command:
#   `turbot graphql --query ./list_deleted_notifications_by_turbot_user.graphql`
#

# Use Cases
# ---------
#
#   Include the user Turbot Identity
#   ----------------------------------
#     1. Get the actor identity id for Turbot identity by running GraphQL example: `get_turbot_actor_identity_id.graphql`.
#     2. Replace `<actor_indentity_id>` with this value.
#     3. Execute this GraphQL script
#
#   Include a particular user
#   ---------------------------
#     1. Get the actor identity id for Turbot identity by running GraphQL example: `get_user_actor_identity_id.graphql`.
#     2. Replace `<actor_indentity_id>` with this value.
#     3. Execute this GraphQL script
#
#
#   Use Update Notification type with the user Turbot Identity
#   ----------------------------------------------------------
#     1. Get the actor identity id for Turbot identity by running GraphQL example: `get_turbot_actor_identity_id.graphql`.
#     2. Replace `<actor_indentity_id>` with this value.  
#     3. Use update notification type like: resource_updated,policy_setting_updated,policy_value_updated,control_updated,
#        action_updated,scheduled_action_updated,grant_updated,active_grants_updated,favorite_updated,watch_updated.
#        (One can select a single notification type or multiple notification type as per the requirement).
#     4. Execute this GraphQL script
#
#   Use Update Notification type with a particular user
#   -------------------------------------------------------
#     1. Get the actor identity id for Turbot identity by running GraphQL example: `get_user_actor_identity_id.graphql`.
#     2. Replace `<actor_indentity_id>` with this value.  
#     3. Use update notification type like: resource_updated,policy_setting_updated,policy_value_updated,control_updated,
#        action_updated,scheduled_action_updated,grant_updated,active_grants_updated,favorite_updated,watch_updated.
#        (One can select a single notification type or multiple notification type as per the requirement).
#     4. Execute this GraphQL script
#
#   Use Create Notification type with the user Turbot Identity
#   ----------------------------------------------------------
#     1. Get the actor identity id for Turbot identity by running GraphQL example: `get_turbot_actor_identity_id.graphql`.
#     2. Replace `<actor_indentity_id>` with this value.  
#     3. Use update notification type like: resource_created,policy_setting_created,policy_value_created,control_created,
#        action_created,scheduled_action_created,grant_created,active_grants_created,favorite_created,watch_created.
#        (One can select a single notification type or multiple notification type as per the requirement).
#     4. Execute this GraphQL script
#
#   Use Create Notification type with a particular user
#   -------------------------------------------------------
#     1. Get the actor identity id for Turbot identity by running GraphQL example: `get_user_actor_identity_id.graphql`.
#     2. Replace `<actor_indentity_id>` with this value.  
#     3. Use update notification type like: resource_created,policy_setting_created,policy_value_created,control_created,
#        action_created,scheduled_action_created,grant_created,active_grants_created,favorite_created,watch_created.
#        (One can select a single notification type or multiple notification type as per the requirement).
#     4. Execute this GraphQL script

# Documentation
# -------------
#
# For full documentation see:
# - Filter documentation: https://turbot.com/v5/docs/reference/filter
# - GraphQL notifications: https://turbot.com/v5/docs/reference/filter/notifications
# - GraphQL notifications type: https://turbot.com/v5/docs/concepts/notifications#notification-types
#

query ListDeletedNotificationsByTurbotUser {
  notifications(filter: "type:resource_deleted,policy_setting_deleted,policy_value_deleted,control_deleted,action_deleted,scheduled_action_deleted,grant_deleted,active_grants_deleted,favorite_deleted,watch_deleted limit:100 actorIdentityId:173249891011852") {
    metadata {
      stats {
        total
      }
    }
    items {
      notificationType
      actor {
        identity {
          title
        }
      }
      resource {
        turbot {
          title
          createTimestamp
          deleteTimestamp
          updateTimestamp
          actorIdentityId
          akas
        }
      }
    }
  }
}