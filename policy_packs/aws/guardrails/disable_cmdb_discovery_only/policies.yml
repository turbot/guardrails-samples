# =============================================================================
# Auto-Generated CMDB Policy Configuration  
# =============================================================================
# Workspace: guardrails-procare.cloud.turbot.com
# Generated: 2026-02-13
#
# Based on installed mods (26 mods)
# =============================================================================

# Critical infrastructure (always enabled)
event_handlers:
  regional:
    type: "tmod:@turbot/aws#/policy/types/eventHandlers"
    value: "Enforce: Configured"
    note: "REQUIRED for real-time event processing"
  global:
    type: "tmod:@turbot/aws#/policy/types/eventHandlersGlobal"
    value: "Enforce: Configured"
    note: "REQUIRED for global event routing"

# Prevention discovery (enabled)
prevention_cmdb:

# Service resource CMDB (disabled for cost)
service_cmdb_skip:
  # EC2 Resources
  ec2_instance:
    type: "tmod:@turbot/aws-ec2#/policy/types/instanceCmdb"
    note: "EC2 > Instance > CMDB"
  ec2_ami:
    type: "tmod:@turbot/aws-ec2#/policy/types/imageCmdb"
    note: "EC2 > Image > CMDB"
  ec2_snapshot:
    type: "tmod:@turbot/aws-ec2#/policy/types/snapshotCmdb"
    note: "EC2 > Snapshot > CMDB"
  ec2_volume:
    type: "tmod:@turbot/aws-ec2#/policy/types/volumeCmdb"
    note: "EC2 > Volume > CMDB"

  # S3 Resources
  s3_bucket:
    type: "tmod:@turbot/aws-s3#/policy/types/bucketCmdb"
    note: "S3 > Bucket > CMDB"

  # RDS Resources
  rds_db_instance:
    type: "tmod:@turbot/aws-rds#/policy/types/dbInstanceCmdb"
    note: "RDS > DB Instance > CMDB"
  rds_db_cluster:
    type: "tmod:@turbot/aws-rds#/policy/types/dbClusterCmdb"
    note: "RDS > DB Cluster > CMDB"

  # Lambda Resources
  lambda_function:
    type: "tmod:@turbot/aws-lambda#/policy/types/functionCmdb"
    note: "Lambda > Function > CMDB"

  # IAM Resources  
  iam_user:
    type: "tmod:@turbot/aws-iam#/policy/types/userCmdb"
    note: "IAM > User > CMDB"
  iam_role:
    type: "tmod:@turbot/aws-iam#/policy/types/roleCmdb"
    note: "IAM > Role > CMDB"
  iam_group:
    type: "tmod:@turbot/aws-iam#/policy/types/groupCmdb"
    note: "IAM > Group > CMDB"
  iam_policy:
    type: "tmod:@turbot/aws-iam#/policy/types/policyCmdb"
    note: "IAM > Policy > CMDB"

  # CloudTrail Resources
  cloudtrail_trail:
    type: "tmod:@turbot/aws-cloudtrail#/policy/types/trailCmdb"
    note: "CloudTrail > Trail > CMDB"

  # CloudWatch Resources  
  cloudwatch_alarm:
    type: "tmod:@turbot/aws-cloudwatch#/policy/types/alarmCmdb"
    note: "CloudWatch > Alarm > CMDB"

  # Config Resources
  config_rule:
    type: "tmod:@turbot/aws-config#/policy/types/ruleCmdb"
    note: "Config > Rule > CMDB"

  # EFS Resources
  efs_file_system:
    type: "tmod:@turbot/aws-efs#/policy/types/fileSystemCmdb"
    note: "EFS > File System > CMDB"

  # EKS Resources
  eks_cluster:
    type: "tmod:@turbot/aws-eks#/policy/types/clusterCmdb"
    note: "EKS > Cluster > CMDB"

  # ElastiCache Resources
  elasticache_cluster:
    type: "tmod:@turbot/aws-elasticache#/policy/types/clusterCmdb"
    note: "ElastiCache > Cluster > CMDB"

  # EventBridge Resources
  events_rule:
    type: "tmod:@turbot/aws-events#/policy/types/ruleCmdb"
    note: "EventBridge > Rule > CMDB"

  # KMS Resources
  kms_key:
    type: "tmod:@turbot/aws-kms#/policy/types/keyCmdb"
    note: "KMS > Key > CMDB"

  # CloudWatch Logs
  logs_log_group:
    type: "tmod:@turbot/aws-logs#/policy/types/logGroupCmdb"
    note: "Logs > Log Group > CMDB"

  # Security Hub
  securityhub_hub:
    type: "tmod:@turbot/aws-securityhub#/policy/types/hubCmdb"
    note: "Security Hub > Hub > CMDB"

  # SNS Resources
  sns_topic:
    type: "tmod:@turbot/aws-sns#/policy/types/topicCmdb"
    note: "SNS > Topic > CMDB"

  # SQS Resources
  sqs_queue:
    type: "tmod:@turbot/aws-sqs#/policy/types/queueCmdb"
    note: "SQS > Queue > CMDB"

  # VPC Resources
  vpc_vpc:
    type: "tmod:@turbot/aws-vpc-core#/policy/types/vpcCmdb"
    note: "VPC > VPC > CMDB"
  vpc_subnet:
    type: "tmod:@turbot/aws-vpc-core#/policy/types/subnetCmdb"
    note: "VPC > Subnet > CMDB"
  vpc_security_group:
    type: "tmod:@turbot/aws-vpc-security#/policy/types/securityGroupCmdb"
    note: "VPC > Security Group > CMDB"
  vpc_internet_gateway:
    type: "tmod:@turbot/aws-vpc-internet#/policy/types/internetGatewayCmdb"
    note: "VPC > Internet Gateway > CMDB"
