recipe:
  name: V3 master account recipe
  resources:
    - name: "Turbot Console Stacks"
      service: cloudformation
      resource: stack
      regions:
        - us-east-1
      filters:
        - type: name_matches
          value: turbot-console
      actions:
        - delete

    - name: "Turbot DB Stacks"
      service: cloudformation
      resource: stack
      regions:
        - us-east-1
      filters:
        - type: name_prefix
          value: Turbot-DB
      actions:
        - delete

    - name: "Turbot Q Stack"
      service: cloudformation
      resource: stack
      regions:
        - us-east-1
      filters:
        - type: name_prefix
          value: Turbot-Q
      actions:
        - delete

    - name: "Turbot CloudFormation Account Stacks"
      service: cloudformation
      resource: stack
      regions:
        - all
      filters:
        - type: name_matches
          value: aaa # Set to Turbot Account ID
      actions:
        - delete

    - name: "Turbot CloudFormation SNS Stacks"
      service: cloudformation
      resource: stack
      regions:
        - all
      filters:
        - type: name_matches
          value: TurbotAWSHandlerSubscriptions
      actions:
        - delete

    - name: "Turbot IAM Policies"
      service: iam
      resource: policy
      regions:
        - us-east-1
      filters:
        - type: path_matches
          value: "/turbot/"
      actions:
        - delete

    - name: "Turbot IAM Groups"
      service: iam
      resource: group
      regions:
        - us-east-1
      filters:
        - type: path_matches
          value: "/turbot/"
      actions:
        - delete

    - name: "Turbot IAM Roles"
      service: iam
      resource: role
      regions:
        - us-east-1
      filters:
        - type: path_matches
          value: "/turbot/" ## v5 turbot_vpc_flow_logging, turbot_ssm_notifications_role, etc.
        - type: path_matches
          value: "/turbot/core/" ## v3 turbot_superuser, turbot_vpc_flow_logs, etc.
      actions:
        - delete

    - name: "Turbot IAM Users"
      service: iam
      resource: user
      regions:
        - us-east-1
      filters:
        - type: path_matches
          value: "/turbot/"
      actions:
        - delete

    - name: "Turbot CodeCommit Repos"
      service: codecommit
      resource: repo
      regions:
        - us-east-1
      filters:
        - type: name_prefix
          value: "turbot-"
      actions:
        - delete

    - name: "Turbot SQS Queues"
      service: sqs
      resource: queue
      regions:
        - us-east-1
      filters:
        - type: name_prefix
          value: Turbot-Q-

    - name: "Turbot DynamoDB Tables"
      service: dynamodb
      resource: table
      regions:
        - us-east-1
      filters:
        - type: name_prefix
          value: "Turbot"
      actions:
        - delete

    - name: "Turbot Cloudwatch Event Rules"
      service: events
      resource: rule
      regions:
        - all
      filters:
        - type: name_prefix
          value: "turbot_aws_"
      actions:
        - delete

    - name: "Turbot Logging Buckets"
      service: s3
      resource: bucket
      regions:
        - us-east-1 # Buckets will process all regions,
          # but just need default region here.
          # don't use 'all'
      filters:
        - type: name_prefix
          value: aaa-
      actions:
        - disable
        - clear

    - name: "Turbot License Bucket"
      service: s3
      resource: bucket
      regions:
        - us-east-1 # Buckets will process all regions,
          # but just need default region here.
          # don't use 'all'
      filters:
        - type: name_prefix
          value: "turbot-"
      actions:
        - disable
        - clear
        - empty
        - delete
